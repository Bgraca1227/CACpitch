/**
 * CAC UtiliTrack - Style Fixes
 * 
 * This file contains CSS fixes for:
 * - Leaflet integration
 * - UI element positioning
 * - Responsive design
 * - Measurement UI
 * - Excavation mode UI
 */

/* ----- Leaflet Fixes ----- */

/* Ensure map container has proper dimensions */
#map {
    width: 100% !important; 
    height: 100% !important;
    z-index: 1 !important;
}

/* Ensure Leaflet controls are visible */
.leaflet-control-container {
    z-index: 1000 !important;
    visibility: visible !important;
    display: block !important;
}

.leaflet-control-attribution {
    z-index: 1000 !important;
    font-size: 10px !important;
}

/* Fix Leaflet controls overlapping with custom controls */
.leaflet-top.leaflet-right {
    top: 130px !important;
}

/* Ensure popups are above other elements */
.leaflet-popup {
    z-index: 1500 !important;
}

.leaflet-popup-content-wrapper {
    max-width: 300px !important;
}

/* ----- Map Controls ----- */

/* Ensure critical map controls are visible */
.map-controls {
    position: absolute !important;
    right: 15px !important;
    top: 80px !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    z-index: 1000 !important;
}

.map-control-button {
    width: 48px !important;
    height: 48px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    background-color: white !important;
    color: #757575 !important;
    border-radius: 9999px !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    cursor: pointer !important;
}

.map-control-button:hover {
    background-color: #f5f5f5 !important;
}

.map-control-button.active {
    color: #2196F3 !important;
    background-color: #e3f2fd !important;
}

/* ----- Utility Toolbar ----- */

.utility-toolbar {
    position: absolute !important;
    top: 5px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    display: flex !important;
    background-color: white !important;
    border-radius: 9999px !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    padding: 4px !important;
    z-index: 1000 !important;
    max-width: 90% !important;
    overflow-x: auto !important;
}

.utility-button {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 4px 8px !important;
    border-radius: 9999px !important;
    background: transparent !important;
    border: none !important;
    cursor: pointer !important;
    white-space: nowrap !important;
    min-width: 40px !important;
}

.utility-button.active {
    background-color: rgba(0,0,0,0.1) !important;
}

/* ----- Action Buttons ----- */

.action-buttons {
    position: absolute !important;
    right: 15px !important;
    bottom: 150px !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 16px !important;
    z-index: 1000 !important;
}

.action-button {
    width: 56px !important;
    height: 56px !important;
    border-radius: 50% !important;
    background-color: var(--primary-color, #2196F3) !important;
    color: white !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    box-shadow: 0 6px 10px rgba(0,0,0,0.1), 0 3px 6px rgba(0,0,0,0.08) !important;
    border: none !important;
    cursor: pointer !important;
    font-size: 24px !important;
}

/* ----- Mode Toggle ----- */

.mode-toggle {
    position: absolute !important;
    left: 50% !important;
    bottom: 80px !important;
    transform: translateX(-50%) !important;
    display: flex !important;
    background-color: white !important;
    border-radius: 9999px !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    padding: 4px !important;
    z-index: 1000 !important;
}

.mode-button {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 16px !important;
    border-radius: 9999px !important;
    background: transparent !important;
    border: none !important;
    cursor: pointer !important;
    gap: 8px !important;
}

.mode-button.active {
    background-color: rgba(0,0,0,0.1) !important;
}

/* ----- Measurement Styles ----- */

.measurement-toolbar {
    position: absolute !important;
    left: 15px !important;
    top: 80px !important;
    background-color: white !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    padding: 8px !important;
    z-index: 1000 !important;
    display: none !important;
}

.measurement-toolbar.visible {
    display: flex !important;
}

.measurement-button {
    width: 40px !important;
    height: 40px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    background-color: transparent !important;
    color: #757575 !important;
    border-radius: 4px !important;
    border: none !important;
    cursor: pointer !important;
}

.measurement-button.active {
    color: #2196F3 !important;
    background-color: #e3f2fd !important;
}

.measuring-cursor {
    cursor: crosshair !important;
}

.measure-point-marker {
    color: #2196F3 !important;
    font-size: 20px !important;
}

.measure-point-marker.start {
    color: #4CAF50 !important;
}

.measure-point-marker.end {
    color: #F44336 !important;
}

.distance-marker {
    background-color: rgba(33, 150, 243, 0.9) !important;
    color: white !important;
    padding: 4px 8px !important;
    border-radius: 4px !important;
    font-size: 12px !important;
    font-weight: bold !important;
    text-align: center !important;
    display: flex !important;
    flex-direction: column !important;
    white-space: nowrap !important;
}

/* ----- Excavation Mode Styles ----- */

.excavation-mode-indicator {
    position: absolute !important;
    top: 10px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    background-color: rgba(244, 67, 54, 0.9) !important;
    color: white !important;
    padding: 8px 16px !important;
    border-radius: 4px !important;
    display: none !important;
    align-items: center !important;
    gap: 8px !important;
    font-weight: bold !important;
    z-index: 1000 !important;
}

.excavation-mode-indicator.visible {
    display: flex !important;
}

.exit-excavation-btn {
    position: absolute !important;
    bottom: 140px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    background-color: #F44336 !important;
    color: white !important;
    padding: 8px 16px !important;
    border-radius: 9999px !important;
    display: none !important;
    align-items: center !important;
    gap: 8px !important;
    font-weight: 500 !important;
    z-index: 1000 !important;
    border: none !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    cursor: pointer !important;
}

.exit-excavation-btn.visible {
    display: flex !important;
}

.proximity-warning {
    stroke: #FFC107 !important;
    stroke-opacity: 0.8 !important;
    stroke-width: 4 !important;
}

.proximity-caution {
    stroke: #FF9800 !important;
    stroke-opacity: 0.9 !important;
    stroke-width: 5 !important;
}

.proximity-danger {
    stroke: #FF5722 !important;
    stroke-opacity: 1 !important;
    stroke-width: 6 !important;
}

.proximity-critical {
    stroke: #F44336 !important;
    stroke-opacity: 1 !important;
    stroke-width: 7 !important;
}

.proximity-alert-container {
    position: absolute !important;
    top: 10px !important;
    right: 10px !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    z-index: 2000 !important;
    max-width: 300px !important;
}

.proximity-alert {
    background-color: white !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08) !important;
    padding: 12px !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    position: relative !important;
    overflow: hidden !important;
}

.proximity-alert:before {
    content: "" !important;
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    bottom: 0 !important;
    width: 4px !important;
}

.proximity-alert.warning:before {
    background-color: #FFC107 !important;
}

.proximity-alert.caution:before {
    background-color: #FF9800 !important;
}

.proximity-alert.danger:before {
    background-color: #FF5722 !important;
}

.proximity-alert.critical:before {
    background-color: #F44336 !important;
}

/* ----- User Location Marker ----- */

.user-location-marker {
    z-index: 1000 !important;
}

.user-location-marker .location-accuracy-circle {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    border-radius: 50% !important;
    background-color: rgba(33, 150, 243, 0.15) !important;
    transform: scale(1.5) !important;
}

.user-location-marker .location-heading {
    position: absolute !important;
    top: -12px !important;
    left: 50% !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 8px solid transparent !important;
    border-right: 8px solid transparent !important;
    border-bottom: 16px solid #2196F3 !important;
    transform-origin: bottom center !important;
    transform: translateX(-50%) rotate(0deg) !important;
    transition: transform 0.5s ease-out !important;
}

/* Animation for critical proximity alerts */
@keyframes pulse-critical {
    0% { stroke-width: 7px; stroke-opacity: 1; }
    50% { stroke-width: 9px; stroke-opacity: 0.8; }
    100% { stroke-width: 7px; stroke-opacity: 1; }
}

@keyframes pulse-danger {
    0% { stroke-width: 6px; stroke-opacity: 1; }
    50% { stroke-width: 8px; stroke-opacity: 0.8; }
    100% { stroke-width: 6px; stroke-opacity: 1; }
}

/* ----- Responsive Design ----- */

/* Small screens (mobile) */
@media (max-width: 768px) {
    .utility-toolbar {
        max-width: 95% !important;
    }
    
    .utility-button {
        padding: 4px 6px !important;
        min-width: 36px !important;
    }
    
    .utility-label {
        font-size: 0.5rem !important;
    }
    
    .mode-toggle {
        width: 95% !important;
        justify-content: space-between !important;
    }
    
    .mode-button {
        padding: 6px 10px !important;
        flex: 1 !important;
    }
    
    .mode-button span {
        font-size: 0.75rem !important;
    }
    
    .map-controls {
        right: 10px !important;
    }
    
    .map-control-button {
        width: 40px !important;
        height: 40px !important;
    }
    
    .action-buttons {
        right: 10px !important;
        bottom: 120px !important;
    }
    
    .exit-excavation-btn {
        bottom: 120px !important;
        font-size: 0.8rem !important;
    }
}

/* Make sure these selectors are always applied */
.visible {
    display: block !important;
}

.hidden {
    display: none !important;
}

/* Fix for z-index stacking issues */
.modal-overlay {
    z-index: 2000 !important;
}

.notification-container {
    z-index: 3000 !important;
}

/* Fix splash screen */
.splash-screen {
    z-index: 9999 !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    background-color: #2196F3 !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    transition: opacity 0.5s !important;
} 